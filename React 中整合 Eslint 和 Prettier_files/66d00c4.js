(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1361:function(t,e,o){"use strict";o(972)},1362:function(t,e,o){(e=o(79)(!1)).push([t.i,'@font-face{font-family:"iconfont";src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358);src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358#iefix) format("embedded-opentype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.woff?t=1470110358) format("woff"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.ttf?t=1470110358) format("truetype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.svg?t=1470110358#iconfont) format("svg")}.iconfont[data-v-2b8d9990]{font-family:"iconfont"!important;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-xlcollection[data-v-2b8d9990]:before{content:"\\e600"}.icon-xlchatbox[data-v-2b8d9990]:before{content:"\\e601"}.comment-form[data-v-2b8d9990]{display:flex;position:relative;padding:1rem 1.333rem;background-color:#fafbfc;border-radius:3px}.comment-form.focused .input-box[data-v-2b8d9990]{border-color:#007fff}.comment-form.reply[data-v-2b8d9990]{margin-top:1.083rem;padding:1rem}.comment-form.reply .avatar-box[data-v-2b8d9990]{display:none}.comment-form.sub-reply[data-v-2b8d9990]{background-color:#fff;border:1px solid #f1f1f2}.avatar-box[data-v-2b8d9990]{flex:0 0 auto}@media (max-width:600px){.avatar-box[data-v-2b8d9990]{display:none}}.avatar[data-v-2b8d9990]{margin:0 1rem 0 0;width:2.667rem;height:2.667rem;border-radius:50%}.form-box[data-v-2b8d9990]{flex:1 1 auto;position:relative}.form-box.disabled[data-v-2b8d9990]:before{content:"";position:absolute;top:0;left:0;right:0;bottom:0;z-index:1}.input-box[data-v-2b8d9990]{font-size:0;background-color:#fff;border:1px solid #f1f1f1;border-radius:3px}.rich-input[data-v-2b8d9990]{position:relative;padding:.6rem 1rem;font-size:1.083rem;line-height:1.7;color:#17181a;outline:none;min-height:1.3em}.rich-input[data-v-2b8d9990]:before{content:attr(placeholder);position:absolute;opacity:.4;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.rich-input[data-v-2b8d9990]:not(.empty):before{display:none}.image-preview-box[data-v-2b8d9990]{display:inline-block;position:relative;margin:0 1rem 1rem}.image-preview-box .image-preview[data-v-2b8d9990]{width:6.667rem;height:6.667rem;background-position:50%;background-repeat:no-repeat;background-size:cover}.image-preview-box .clean-btn[data-v-2b8d9990]{position:absolute;top:.333rem;right:.333rem;cursor:pointer}.image-preview-box .clean-btn[data-v-2b8d9990]:hover{opacity:.8}.action-box[data-v-2b8d9990]{display:flex;align-items:center;margin:.65rem 0 0}@media (max-width:600px){.action-box .emoji-btn[data-v-2b8d9990]{display:none}}[data-v-2b8d9990] .action-box .emoji-btn span{font-size:13px}.image-btn[data-v-2b8d9990]{flex:0 0 auto;display:flex;align-items:center;font-size:1.083rem;color:#027fff;cursor:pointer;margin-left:20px}.image-btn[data-v-2b8d9990]:hover{opacity:.8}.image-btn .icon[data-v-2b8d9990]{margin-right:.333rem;width:18px;height:18px}.submit[data-v-2b8d9990]{flex:0 0 auto;margin-left:auto}.submit span[data-v-2b8d9990]{color:#c2c2c2;margin-right:8px;font-size:13px}.submit .submit-btn[data-v-2b8d9990]{flex:0 0 auto;margin-left:auto;padding:.5rem 1.3rem;font-size:1.25rem;color:#fff;background-color:#027fff;border-radius:2px;cursor:pointer}.submit .submit-btn[data-v-2b8d9990]:hover{background-color:#0371df}.submit .submit-btn[data-v-2b8d9990]:disabled{cursor:default;opacity:.4}[data-v-2b8d9990] .rich-input .emoji{vertical-align:sub;width:1.666rem;height:1.666rem;cursor:default;margin:0 1px}',""]),t.exports=e},1363:function(t,e,o){"use strict";o(973)},1364:function(t,e,o){(e=o(79)(!1)).push([t.i,'@font-face{font-family:"iconfont";src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358);src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358#iefix) format("embedded-opentype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.woff?t=1470110358) format("woff"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.ttf?t=1470110358) format("truetype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.svg?t=1470110358#iconfont) format("svg")}.iconfont[data-v-35801ab3]{font-family:"iconfont"!important;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-xlcollection[data-v-35801ab3]:before{content:"\\e600"}.icon-xlchatbox[data-v-35801ab3]:before{content:"\\e601"}.sub-comment[data-v-35801ab3]{position:relative;padding:1rem 0 0}.sub-comment:hover .removable[data-v-35801ab3]{display:block}.sub-comment-content-row[data-v-35801ab3]{display:flex;align-items:flex-start}.sub-comment-content-box[data-v-35801ab3]{display:flex;width:100%}.popover[data-v-35801ab3]{height:33px}.avatar[data-v-35801ab3]{width:2.667rem;height:2.667rem;border-radius:50%}.user-content-box[data-v-35801ab3]{margin-left:.833rem;margin-right:1rem;padding-bottom:12px;font-size:1.083rem;color:#17181a;width:100%}.user-content-box .profie[data-v-35801ab3]{display:flex}.user-content-box .profie .username[data-v-35801ab3]{font-weight:400;font-size:1.083rem;color:#333;margin-right:4px}.user-content-box .profie .author-badge-text[data-v-35801ab3]{margin-left:4px}.user-content-box .profie .position[data-v-35801ab3]{color:#8a9aa9;font-size:13px;font-weight:400;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:13.5rem}@media (max-width:600px){.user-content-box .profie .position[data-v-35801ab3]{max-width:10rem}}@media (max-width:320px){.user-content-box .profie .position[data-v-35801ab3]{max-width:5rem}}.user-content-box .content-box[data-v-35801ab3]{display:inline-block;margin-top:.5rem;overflow:hidden}.user-content-box .content-box .content[data-v-35801ab3]{white-space:pre-wrap;color:#505050;line-height:1.833rem}.user-content-box .limit-btn[data-v-35801ab3]{color:#007fff;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.user-content-box .limit-btn[data-v-35801ab3]:hover{opacity:.8}.user-content-box .limit-btn.all[data-v-35801ab3]{display:inline-block;margin:.4rem 0}.user-content-box .image[data-v-35801ab3]{margin:0 .5em;color:#406599;cursor:pointer;position:relative;vertical-align:super}.user-content-box .image a.image-preview[data-v-35801ab3]{position:relative;z-index:1;display:none;padding:8px;position:absolute;margin-left:17px;top:2rem;left:0;background-color:#fff;border-radius:2px;box-shadow:0 5px 18px 0 rgba(0,0,0,.16);border:.5px solid hsla(0,0%,59.2%,.2);transform:translate(-50%)}@media (max-width:600px){.user-content-box .image a.image-preview[data-v-35801ab3]{display:none}}.user-content-box .image a.image-preview .image[data-v-35801ab3]{width:200px;height:100%;min-height:170px;margin:0}.user-content-box .image a.image-preview .triangle-top[data-v-35801ab3]{position:absolute;top:-8px;left:50%;margin:-7px 0 0 -7px}.user-content-box .image:hover a.image-preview[data-v-35801ab3]{display:inline-block}.sub-comment-stat-box[data-v-35801ab3]{display:flex;margin-top:7px;font-size:13px;color:#8a93a0}.sub-comment-stat-box .delete[data-v-35801ab3]{cursor:pointer;display:none}.sub-comment-action-box[data-v-35801ab3]{flex:0 0 auto;display:flex;justify-content:space-between;margin-left:auto;min-width:8.8rem;font-size:1.083rem;color:#8a93a0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}@media (max-width:600px){.sub-comment-action-box[data-v-35801ab3]{display:none}}.sub-comment-action-box .comment-action span[data-v-35801ab3]{margin-left:6px}.sub-comment-action-box .action[data-v-35801ab3]{display:flex;align-items:center;margin-left:.5rem;cursor:pointer}.sub-comment-action-box .action[data-v-35801ab3]:hover{opacity:.8}.sub-comment-action-box .action.active[data-v-35801ab3]{color:#37c700}.sub-comment-action-box .action-title[data-v-35801ab3]{margin-left:.25rem}.sub-comment[data-v-35801ab3] .reply-form .triangle{display:none}.content .emoji[data-v-35801ab3],[data-v-35801ab3] .rich-input .emoji{width:1.666rem;height:1.666rem;vertical-align:sub}[data-v-35801ab3] .content .emoji{width:1.5rem;height:1.5rem;vertical-align:sub;margin-right:2px}[data-v-35801ab3] .content .emoji:first-child{margin-left:4px}[data-v-35801ab3] .content .emoji:last-child{margin-right:4px}[data-v-35801ab3] .user-popover-box{display:inline-block}[data-v-35801ab3] .user-popover-box a.be-replied{color:#406599}@media (max-width:600px){.sub-comment-stat-box .visible[data-v-35801ab3]{display:block}}',""]),t.exports=e},1365:function(t,e,o){"use strict";o(974)},1366:function(t,e,o){(e=o(79)(!1)).push([t.i,".sub-comment-list[data-v-21b4b888]{margin:1rem 0;padding:0 0 0 1rem;background-color:#fafbfc;border-radius:3px}.sub-comment-list .item[data-v-21b4b888]:not(:last-child) .user-content-box{border-bottom:1px solid #f1f1f1}.fetch-more[data-v-21b4b888]{display:flex;justify-content:center;align-items:center}.fetch-more-comment[data-v-21b4b888]{display:inline-block;margin:1rem 0;font-size:1.083rem;color:#406599;cursor:pointer}.fetch-more-comment[data-v-21b4b888]:hover{opacity:.8}",""]),t.exports=e},1367:function(t,e,o){"use strict";o(975)},1368:function(t,e,o){(e=o(79)(!1)).push([t.i,'@font-face{font-family:"iconfont";src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358);src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358#iefix) format("embedded-opentype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.woff?t=1470110358) format("woff"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.ttf?t=1470110358) format("truetype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.svg?t=1470110358#iconfont) format("svg")}.iconfont[data-v-712cf1e5]{font-family:"iconfont"!important;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-xlcollection[data-v-712cf1e5]:before{content:"\\e600"}.icon-xlchatbox[data-v-712cf1e5]:before{content:"\\e601"}.comment[data-v-712cf1e5]{display:flex}.popover[data-v-712cf1e5]{height:33px}.user-link[data-v-712cf1e5]{flex:0 0 auto}.avatar[data-v-712cf1e5]{width:2.667rem;height:2.667rem;border-radius:50%}.content-box[data-v-712cf1e5]{margin-left:.833rem;flex:1 1 auto}.content-box:hover .removable[data-v-712cf1e5]{display:block;cursor:pointer}.meta-box[data-v-712cf1e5]{display:flex;align-items:center;font-size:1.083rem;line-height:1.25;white-space:nowrap}.meta-box .username[data-v-712cf1e5]{font-size:1.083rem;font-weight:400;flex:1 1 auto;width:0;color:#333}.meta-box .author-badge-text[data-v-712cf1e5]{margin-left:4px}.meta-box .position[data-v-712cf1e5]{color:#8a9aa9;font-size:1.083rem;margin-left:4px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:16rem}@media (max-width:600px){.meta-box .position[data-v-712cf1e5]{max-width:12rem}}@media (max-width:320px){.meta-box .position[data-v-712cf1e5]{max-width:5rem}}.reply-stat[data-v-712cf1e5]{display:flex;margin-top:7px;font-weight:400}.reply-stat .delete[data-v-712cf1e5],.reply-stat .time[data-v-712cf1e5]{font-size:1.083rem;color:#8a9aa9;cursor:default}.reply-stat .delete[data-v-712cf1e5]{display:none}.reply-stat .mobile[data-v-712cf1e5]{display:block;cursor:pointer}.reply-stat .action-box[data-v-712cf1e5]{flex:0 0 auto;display:flex;justify-content:space-between;margin-left:auto;min-width:8.8rem;color:#8a93a0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.reply-stat .action-box .comment-action span[data-v-712cf1e5]{margin-left:6px}.reply-stat .action-box .action[data-v-712cf1e5]{display:flex;align-items:center;margin-left:.5rem;cursor:pointer}.reply-stat .action-box .action[data-v-712cf1e5]:hover{opacity:.8}.reply-stat .action-box .action.active[data-v-712cf1e5]{color:#37c700}.reply-stat .action-box .action-title[data-v-712cf1e5]{margin-left:.25rem}.content[data-v-712cf1e5]{margin-top:.55rem;font-size:1.083rem;line-height:1.833rem;word-wrap:break-word;white-space:pre-wrap;color:#505050;overflow:hidden}.limit-btn[data-v-712cf1e5]{font-size:1.083rem;display:inline-block;margin-top:.4rem;color:#007fff;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.limit-btn[data-v-712cf1e5]:hover{opacity:.8}.image[data-v-712cf1e5]{margin-top:.8rem;width:6.667rem;height:6.667rem;background-position:50%;background-repeat:no-repeat;background-size:cover;cursor:zoom-in}.content .emoji[data-v-712cf1e5],[data-v-712cf1e5] .content .emoji,[data-v-712cf1e5] .rich-input .emoji{width:1.666rem;height:1.666rem;vertical-align:sub}[data-v-712cf1e5] .content .emoji{margin-right:2px}[data-v-712cf1e5] .content .emoji:first-child{margin-left:4px}[data-v-712cf1e5] .content .emoji:last-child{margin-right:4px}[data-v-712cf1e5] .content .parse-emoji-url img{height:1.333rem}@media (max-width:600px){.reply-stat .mobile[data-v-712cf1e5]{display:block}}',""]),t.exports=e},1369:function(t,e,o){"use strict";o(976)},1370:function(t,e,o){(e=o(79)(!1)).push([t.i,".comment-list .item[data-v-7d46cf26]:not(:last-child){margin-bottom:1.333rem}.comment-list .item[data-v-7d46cf26]:not(:last-child) .comment-divider-line{border-bottom:1px solid #f1f1f1}",""]),t.exports=e},1371:function(t,e,o){"use strict";o(977)},1372:function(t,e,o){(e=o(79)(!1)).push([t.i,'@font-face{font-family:"iconfont";src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358);src:url(https://b-gold-cdn.xitu.io/fonts/iconfont.eot?t=1470110358#iefix) format("embedded-opentype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.woff?t=1470110358) format("woff"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.ttf?t=1470110358) format("truetype"),url(https://b-gold-cdn.xitu.io/fonts/iconfont.svg?t=1470110358#iconfont) format("svg")}.iconfont[data-v-dace33a0]{font-family:"iconfont"!important;font-style:normal;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.icon-xlcollection[data-v-dace33a0]:before{content:"\\e600"}.icon-xlchatbox[data-v-dace33a0]:before{content:"\\e601"}.comment-list-box[data-v-dace33a0]{position:relative;border-top:1px solid #ebebeb;padding-top:1.333rem}.comment-list-box[data-v-dace33a0]:after,.comment-list-box[data-v-dace33a0]:before{display:table;content:"";clear:both}.comment-list-box .triangle-top[data-v-dace33a0]{position:absolute;top:-8px;left:50%;margin:-7px 0 0 -7px}.comment-list-box .title[data-v-dace33a0]{color:#8a9aa9;font-size:16px;font-weight:400;text-align:center;padding:1.67rem 0 5px}.comment-form[data-v-dace33a0]{margin:0 1.666rem 1.333rem}@media (max-width:600px){.comment-form[data-v-dace33a0]{margin:1.25rem 2rem}}.comment-list[data-v-dace33a0]{margin:0 1.666rem 0 6.5rem}@media (max-width:600px){.comment-list[data-v-dace33a0]{margin:0 2rem}}.fetch-more-comment[data-v-dace33a0]{display:block;padding:1.1rem 0;font-size:1.083rem;text-align:center;color:#406599;border-top:1px solid #ebebeb;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.fetch-more-comment[data-v-dace33a0]:hover{opacity:.8}@media (max-width:600px){.sticky[data-v-dace33a0]{border-top:none;margin:1rem 0}}',""]),t.exports=e},462:function(t,e,o){"use strict";var n=o(82),r=o(173),c={components:{Lazy:o(172).a},props:["url","default","quality","width","height","shrink","format","size","alt","blank"],computed:{defaultThumbUrl:function(){return this.default||n.f},thumbUrl:function(){var t=this.url||(this.blank?"":this.defaultThumbUrl);return this.shrink?Object(r.c)(t,this.width,this.height,{format:this.format,quality:this.quality}):Object(r.a)(t,this.width,this.height,{format:this.format,quality:this.quality})}}},l=o(26),component=Object(l.a)(c,(function(){var t=this.$createElement;return(this._self._c||t)("lazy",{attrs:{url:this.thumbUrl,alt:this.alt}})}),[],!1,null,null,null);e.a=component.exports},472:function(t,e,o){"use strict";o.d(e,"a",(function(){return c})),o.d(e,"b",(function(){return l}));o(28);var n=o(47),r=o(38),c=function(text){try{var textarea=document.createElement("textarea");document.body.appendChild(textarea),textarea.value=text,textarea.select(),document.execCommand("copy"),document.body.removeChild(textarea)}catch(t){throw"copy link error"}};function l(t){var e=Object(r.e)(),o=Object(n.f)(t).query,c=Object(n.d)(t),l="webp"===o.f,m="gif"===o.f,d=c?+o.w:0,f=c?+o.h:0,h=e&&!m,v=!e&&l,_=m?"?imageslim":["?imageView2/0","/w/".concat(1280),"/h/".concat(960),h?"/format/webp":v?"/format/png":"","/ignore-error/1"].join(""),y=c?"".concat(t.replace(/\?.*$/,"")).concat(_):t,x=800,w=600;if(d&&f){var C=d/1280,k=f/1280,j=Math.max(C,k);j>1?(x=Math.floor(d/j),w=Math.floor(f/j)):(x=d,w=f)}return{url:y,width:x,height:w}}},474:function(t,e,o){var content=o(496);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(80).default)("68f85995",content,!0,{sourceMap:!1})},478:function(t,e,o){"use strict";o.r(e);o(27),o(22),o(12),o(6),o(21);var n=o(0),r=o(1),c=o(461),l=o(171),m=o(487),d=o(17),f=o(54);function h(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(object);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,o)}return e}function v(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?h(Object(source),!0).forEach((function(e){Object(n.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):h(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var _={components:{Avatar:l.a,Triangle:m.a},props:["userId"],data:function(){return{user:null,followLock:Object(c.a)(),visible:!1,top:0,left:0,isTop:!1}},computed:v(v({},Object(f.mapGetters)({currentUser:r.USER})),{},{popoverStyle:function(){return{top:"".concat(this.top,"px"),left:"".concat(this.left,"px")}},position:function(){return this.user&&(this.$userPosition(this.user)||this.user.description||"暂无简介")},self:function(){return this.currentUser&&this.currentUser.id===this.userId},followed:function(){return this.user&&this.user.followed}}),methods:{toFollowing:function(){window.open("/user/".concat(this.userId,"/following"),"_blank")},toFollower:function(){window.open("/user/".concat(this.userId,"/followers"),"_blank")},fetch:function(){var t=this;return Object(d.h)(this.userId).then((function(e){t.user=e}))},toggleFollow:function(){var t=this;this.followLock.do((function(){return t.$ensureAuthorized().then((function(){return t.$store.dispatch(r.TOGGLE_FOLLOW_USER,t.user).catch((function(e){t.$error(e)}))})).catch((function(){}))}))},showPopover:function(t){var e=this;clearTimeout(this.hideToken),this.showToken=setTimeout((function(){e.fetch().then((function(){e.showToken&&(e.visible=!0,e.$nextTick((function(){var o=t.target.getBoundingClientRect(),n=t.target.offsetWidth||33,r=t.target.offsetHeight||33,c=e.$refs.popover,l=null==c?void 0:c.offsetWidth,m=null==c?void 0:c.offsetHeight,d=o.left-l/2+n/2,f=o.top-m-12;e.isTop=!1,f<60&&(e.isTop=!0,f=o.top+r+8),d=Math.max(0,d),e.left=d,e.top=f})))}))}),300)},hidePopover:function(){var t=this;clearTimeout(this.showToken),this.showToken=null,this.hideToken=setTimeout((function(){t.popoverTimeout=null,t.visible=!1}),300)}}},y=(o(517),o(26)),component=Object(y.a)(_,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"user-popover-box",attrs:{"st:block":"userPopover","st:state":t.userId},on:{mouseenter:function(e){return t.showPopover(e)},mouseleave:t.hidePopover}},[o("transition",{attrs:{name:"fade"}},[t.visible?o("div",{ref:"popover",staticClass:"user-popover",style:t.popoverStyle},[o("div",{staticClass:"info-row"},[o("app-link",{attrs:{to:t.$userRoute(t.user),blank:!0}},[o("avatar",{staticClass:"avatar",attrs:{user:t.user,decorative:!0,alt:t.user.username+"的头像"}})],1),t._v(" "),o("div",{staticClass:"user-info"},[o("username",{attrs:{user:t.user}}),t._v(" "),o("div",{staticClass:"position"},[t._v(t._s(t.position))])],1)],1),t._v(" "),o("div",{staticClass:"meta-row"},[o("ul",{staticClass:"meta-list"},[o("li",{staticClass:"item",on:{click:t.toFollowing}},[o("div",{staticClass:"count"},[t._v(t._s(t.user.followingCount||0))]),t._v(" "),o("div",{staticClass:"title"},[t._v("关注")])]),t._v(" "),o("li",{staticClass:"item",on:{click:t.toFollower}},[o("div",{staticClass:"count"},[t._v(t._s(t.user.followerCount||0))]),t._v(" "),o("div",{staticClass:"title"},[t._v("关注者")])])]),t._v(" "),t.self?t._e():o("button",{staticClass:"follow-btn",class:{followed:t.followed},attrs:{"st:name":"followBtn"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.toggleFollow(e)}}},[o("span",{directives:[{name:"show",rawName:"v-show",value:t.followLock.busy,expression:"followLock.busy"}],staticClass:"busy-icon ion-load-c"}),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:!t.followLock.busy,expression:"!followLock.busy"}]},[t._v("\n            "+t._s(t.followed?"已关注":"关注")+"\n          ")])])]),t._v(" "),o("triangle",{staticClass:"triangle-bottom",class:{isTop:t.isTop}})],1):t._e()]),t._v(" "),t._t("default")],2)}),[],!1,null,"7ed5cb74",null);e.default=component.exports},482:function(t,e,o){var content=o(518);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(80).default)("aef2b4be",content,!0,{sourceMap:!1})},487:function(t,e,o){"use strict";o(495);var n=o(26),component=Object(n.a)({},(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("span",{staticClass:"container"},[e("em",{staticClass:"triangle"})])}],!1,null,"68da8972",null);e.a=component.exports},495:function(t,e,o){"use strict";o(474)},496:function(t,e,o){(e=o(79)(!1)).push([t.i,".container[data-v-68da8972]{width:14px;height:14px;position:relative;border-top:1px solid #fff;transform:rotate(180deg);display:inline-block}.container .triangle[data-v-68da8972]{position:absolute;margin:auto;top:-6px;left:0;right:0;width:10px;height:10px;transform:rotate(45deg);-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-o-transform:rotate(45deg);-ms-transform:rotate(45deg);border-right:1px solid #ebebeb;border-bottom:1px solid #ebebeb;background:#fff}",""]),t.exports=e},517:function(t,e,o){"use strict";o(482)},518:function(t,e,o){(e=o(79)(!1)).push([t.i,".user-popover-box[data-v-7ed5cb74]{display:inline}.user-popover[data-v-7ed5cb74]{position:fixed;top:20rem;left:2rem;padding:1.333rem 1.333rem 1.833rem;width:267px;max-height:160px;font-weight:400;line-height:1.2;background-color:#fff;border:1px solid #ebebeb;box-shadow:0 2px 6px 0 rgba(0,0,0,.08);box-sizing:border-box;border-radius:2px;cursor:default;z-index:250}@media (max-width:$width-small){.user-popover[data-v-7ed5cb74]{display:none}}.info-row[data-v-7ed5cb74]{display:flex}.info-row .avatar[data-v-7ed5cb74]{margin-right:1rem;width:4.833rem;height:4.833rem;border-radius:50%;border:1px solid #fff;box-shadow:0 2px 6px 0 rgba(0,0,0,.15)}.info-row .user-info[data-v-7ed5cb74]{line-height:1}.info-row .user-info .username[data-v-7ed5cb74]{margin-top:.333rem;font-size:1.25rem;line-height:1.2;font-weight:500;color:#333;display:inline-block;vertical-align:middle}.info-row .user-info .position[data-v-7ed5cb74]{margin:1.5rem 0 0;font-size:1.083rem;line-height:1.2;max-width:165px;color:#8f969c;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.meta-row[data-v-7ed5cb74]{display:flex;align-items:flex-end;margin-top:1.5rem}.meta-row .meta-list[data-v-7ed5cb74]{flex:1 1 auto;display:flex;margin:0;padding:0;list-style:none}.meta-row .meta-list .item[data-v-7ed5cb74]{flex:1 1 auto;cursor:pointer}.meta-row .meta-list .item .count[data-v-7ed5cb74]{font-size:1.25rem;font-weight:600;color:#17181a}.meta-row .meta-list .item .title[data-v-7ed5cb74]{margin-top:.666rem;font-size:13px;color:#8f969c}.meta-row .follow-btn[data-v-7ed5cb74]{flex:0 0 auto;margin:0 0 0 1rem;padding:0;width:6.167rem;height:2.5rem;font-size:1.25rem;letter-spacing:normal;color:#37c701;background-color:#fff;border:1px solid #37c701;border-radius:2px}.meta-row .follow-btn[data-v-7ed5cb74]:hover:not(:disabled){opacity:.8}.meta-row .follow-btn.followed[data-v-7ed5cb74]{color:#fff;background-color:#1fd200}.meta-row .follow-btn[data-v-7ed5cb74]:disabled{color:#ccc;border-color:#ccc}.triangle-bottom[data-v-7ed5cb74]{position:absolute;bottom:-15px;left:50%;margin-left:-5px}.triangle-bottom.container[data-v-7ed5cb74]{transform:rotate(0deg)}.triangle-bottom.isTop[data-v-7ed5cb74]{bottom:158px}.triangle-bottom.isTop.container[data-v-7ed5cb74]{transform:rotate(180deg)}.fade-enter-active[data-v-7ed5cb74],.fade-leave-active[data-v-7ed5cb74]{transition:opacity .2s}.fade-enter[data-v-7ed5cb74],.fade-leave-to[data-v-7ed5cb74]{opacity:0}",""]),t.exports=e},570:function(t,e,o){"use strict";var n=o(103),r=o(43),c=o(487),l=(o(28),o(6),o(64),o(36)),m=(o(33),o(8)),d=o(1),f=o(774),h=o(171),v=o(779),_=o(761),y=o(117),x=o(505),w=o(557),C=o(490),k=o(481),j=o(3);function L(t){var e=t.reply_to_comment_id,o=t.reply_to_reply_id,n=t.reply_to_user_id,r=t.item_id,c=t.item_type,l=t.reply_content,m=t.reply_pics;return Object(j.a)({url:"/interact_api/v1/reply/publish",method:"post",body:{reply_to_comment_id:e,reply_to_reply_id:o,reply_to_user_id:n,item_id:r,item_type:c,reply_content:l,reply_pics:m,client_type:2608}})}function $(t){var e=t.item_id,o=t.item_type,cursor=t.cursor,n=t.limit;return Object(j.a)({url:"/interact_api/v1/comment/list",method:"post",body:{item_id:e,item_type:o,cursor:cursor,limit:n,client_type:2608}})}var z=o(530),O={2:"article",4:"pin",13:"小册"},F={components:{AuthCard:v.a,Avatar:h.a,Emoji:f.a},props:["commentList","replyList","subject","comment","parent","autoFocus","placeholder"],data:function(){return{emojis:_.a,active:!1,focused:!1,submitting:!1,content:"",imageFile:null,imagePreviewUrl:"",emoji:""}},computed:{me:function(){return this.$store.getters.USER},bindedPhone:function(){return this.me&&this.me.isBindedPhone},empty:function(){return!this.content.length},canSubmit:function(){return this.content.length&&!this.submitting},isActionBoxVisible:function(){return(this.focused||!this.empty||this.imageFile)&&this.me&&this.bindedPhone},submitButtonTitle:function(){return this.submitting?"提交中...":"评论"}},watch:{focused:function(t){t&&!this.me&&this.$requestLogin(),t||!this.empty||this.imageFile||(this.$emit("emptyBlur"),this.$store.dispatch(d.UPDATE_PIN_ON_FOCUS,!1))},imageFile:function(){Object(x.d)(this.$refs.richInput)}},methods:{onFocus:function(){this.focused=!0,this.$store.dispatch(d.UPDATE_PIN_ON_FOCUS,!0)},onOuterClick:function(){this.empty&&(this.focused=!1)},onFormBoxClick:function(t){var e=t.target;if(this.bindedPhone){var input=this.$refs.richInput;input.focus(),input.contains(e)||Object(x.d)(input)}},onInput:function(){this.focused=!0,this.content=this.emojiToText(this.$refs.richInput.innerHTML),this.content=Object(x.a)(this.content)},onPaste:function(t){Object(x.c)(t,this.onFileSelected),Object(x.b)(t)},onKeydown:function(t){var e=this;if(this.content.length&&!this.submitting)return Object(w.a)(t,(function(){return e.submit()}))},cleanContent:function(){this.$refs.richInput.innerHTML="<br/>",this.content=""},updateEmoji:function(t){this.emoji=t;var e=this.$refs.richInput;t=Object(y.emojiToImage)(t);var o=document.queryCommandSupported("InsertHTML");this.content.length||e.focus(),o&&document.execCommand("insertHTML",!1,t),this.onInput()},showFileDialog:function(){this.$refs.input.click()},changeFile:function(t){this.imageFile=t,window.URL.revokeObjectURL(this.imagePreviewUrl),this.imagePreviewUrl=t?window.URL.createObjectURL(t):""},cleanFile:function(){this.changeFile(null)},onFileSelected:function(t){var e=this;this.$refs.input.value=null,t&&(this.isWithVaildSize(t)?Object(C.a)(t,k.a).then((function(o){o?e.changeFile(t):e.$error("不支持此格式的图片")})):this.$error("文件过大"))},isWithVaildSize:function(t){return t.size<=k.c},uploadFile:function(){var t=this;return Object(m.a)(regeneratorRuntime.mark((function e(){var o,n,r,c,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.imageFile){e.next=11;break}return e.next=3,Object(z.a)(t.me.user_id,[t.imageFile]);case 3:return o=e.sent,n=Object(l.a)(o,1),r=n[0],c=t.imageFile.type.split("/")[1],m={gif:0,png:1,jpg:2,jpeg:2},e.abrupt("return",{pic_url:r.Url,width:r.ImageHeight,height:r.ImageWidth,pic_type:m[c]||1});case 11:return e.abrupt("return",Promise.resolve());case 12:if(!t.imageFile){e.next=18;break}return e.next=15,Object(z.a)(t.me.user_id,[t.imageFile]);case 15:e.t0=e.sent,e.next=19;break;case 18:e.t0=Promise.resolve();case 19:return e.abrupt("return",e.t0);case 20:case"end":return e.stop()}}),e)})))()},submit:function(){var t=this;return this.submitting=!0,this.uploadFile().then((function(image){return t.createSubmitTask(image)})).then((function(e){0===e.err_no?(t.$emit("syncCommentNum",{type:"add"}),t.submitting=!1,t.$alertMsg("评论成功"),t.$emit("submitted"),t.reset()):t.$error(e.err_msg||"评论失败，请稍后重试")})).catch((function(e){t.submitting=!1,t.$error(e)}))},createSubmitTask:function(image){var t=this,e=this.subject,o=e.item_id,n=e.item_type;return this.$TEA("comment_action",{comment_type:O[n],comment_parent_id:o,author_user_id:this.subject.user_id}),this.comment?this.comment.reply_info?L({reply_to_comment_id:this.comment.reply_info.reply_comment_id,reply_to_reply_id:this.comment.reply_info.reply_id,reply_to_user_id:this.comment.reply_info.user_id,item_id:o,item_type:n,reply_content:this.content,reply_pics:void 0===image?[]:[image]}).then((function(e){return 0===e.err_no&&(t.replyList||[]).push(e.data),e})):L({reply_to_comment_id:this.comment.comment_info.comment_id,reply_to_reply_id:null,reply_to_user_id:null,item_id:o,item_type:n,reply_content:this.content,reply_pics:void 0===image?[]:[image]}).then((function(e){return 0===e.err_no&&(t.replyList||[]).push(e.data),e})):function(t){var e=t.item_id,o=t.item_type,n=t.comment_content,r=t.comment_pics;return Object(j.a)({url:"/interact_api/v1/comment/publish",method:"post",body:{item_id:e,item_type:o,comment_content:n,comment_pics:r,client_type:2608}})}({item_id:o,item_type:n,comment_content:this.content,comment_pics:void 0===image?[]:[image]}).then((function(e){return 0===e.err_no&&t.commentList.unshift(e.data),e}))},reset:function(){this.cleanFile(),this.cleanContent()},emojiToText:function(html){return html.replace(/<img.*?alt=".*?/g,"").replace(/".?src=.*?>/g,"")}},mounted:function(){var t=this;this.autoFocus&&this.$nextTick((function(){t.$refs.richInput.focus()}))}},S=(o(1361),o(26)),U=Object(S.a)(F,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"outer-click",rawName:"v-outer-click",value:function(){return t.onOuterClick()},expression:"() => onOuterClick()"}],staticClass:"comment-form",class:{focused:t.focused,reply:!!t.comment,"sub-reply":!!t.parent}},[o("div",{staticClass:"avatar-box"},[o("avatar",{staticClass:"avatar",attrs:{user:t.me}})],1),o("div",{staticClass:"form-box",class:{disabled:t.submitting},on:{click:t.onFormBoxClick}},[o("auth-card",{attrs:{user:t.me}},[o("div",{staticClass:"input-box"},[o("div",{ref:"richInput",staticClass:"rich-input",class:{empty:t.empty},attrs:{contenteditable:"true",spellcheck:"false",placeholder:t.placeholder||"输入评论...",disabled:!0},on:{focus:t.onFocus,input:t.onInput,paste:t.onPaste,keydown:t.onKeydown}},[o("br")]),t.imagePreviewUrl?o("div",{staticClass:"image-preview-box"},[o("div",{staticClass:"image-preview",style:{backgroundImage:"url("+t.imagePreviewUrl+")"}}),o("div",{staticClass:"clean-btn",on:{click:t.cleanFile}},[o("svg",{staticClass:"icon close-icon",attrs:{"aria-hidden":"true",width:"14",height:"14",viewBox:"0 0 21 21"}},[o("g",{attrs:{fill:"none","fill-rule":"evenodd",transform:"translate(1 1)"}},[o("circle",{attrs:{cx:"9.5",cy:"9.5",r:"9.5",fill:"#000",stroke:"#FFF",opacity:".5"}}),t._v(" "),o("path",{attrs:{fill:"#FFF",d:"M13.743 5.964L10.207 9.5l3.536 3.536-.707.707L9.5 10.207l-3.536 3.536-.707-.707L8.793 9.5 5.257 5.964l.707-.707L9.5 8.793l3.536-3.536z"}})])])])]):t._e()])]),t.isActionBoxVisible?o("div",{staticClass:"action-box"},[o("emoji",{staticClass:"emoji-btn",attrs:{emoji:t.emojis,user:t.me},on:{selectEmoji:t.updateEmoji}}),o("div",{staticClass:"image-btn",on:{click:t.showFileDialog}},[o("svg",{staticClass:"icon image-icon",attrs:{"aria-hidden":"true",width:"22",height:"22",viewBox:"0 0 22 22"}},[o("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[o("path",{attrs:{d:"M1 1h20v20H1z"}}),t._v(" "),o("g",{attrs:{transform:"translate(2 3)"}},[o("path",{attrs:{stroke:"#027FFF","stroke-width":".9",d:"M2.28.667h13.44c1.075 0 1.947.871 1.947 1.946v10.774a1.947 1.947 0 0 1-1.947 1.946H2.28a1.947 1.947 0 0 1-1.947-1.946V2.613c0-1.075.872-1.946 1.947-1.946zM.333 12.499L5 8l9.01 7.333m-6.343-4.842L10.333 8l7.136 5.914"}}),t._v(" "),o("circle",{attrs:{cx:"13.5",cy:"4.5",r:"1.5",fill:"#027FFF"}})])])]),t._v(" "),o("span",[t._v("图片")])]),o("div",{staticClass:"submit"},[o("span",[t._v("Ctrl or ⌘ + Enter")]),o("button",{staticClass:"submit-btn",attrs:{disabled:!t.canSubmit},on:{click:t.submit}},[t._v(t._s(t.submitButtonTitle))])])],1):t._e()],1),o("input",{ref:"input",staticClass:"hidden",attrs:{type:"file"},on:{change:function(e){return t.onFileSelected(e.target.files[0])}}})])}),[],!1,null,"2b8d9990",null).exports,M=o(501),A=o(461),T=o(176),R=o(462),P=o(478),I=o(50),N={components:{CommentForm:U,UserPopover:P.default,Avatar:h.a,Triangle:c.a,Thumb:R.a},props:["replyList","subject","parent","reply","removable","user"],data:function(){return{likeLock:Object(A.a)(),isReplyFormVisible:!1,isShowAll:!1,isLikeLoading:!1}},computed:{currentUser:function(){var t=this.$store.getters;return"USER"in t?t.USER:null},removableReply:function(){return this.removable||this.isCurrentUsersReply()},hasAuthorBadge:function(){return this.subject.user_id===this.reply.user_info.user_id},position:function(){return this.$userPosition(this.reply.user_info)},imageUrl:function(){return this.reply.reply_info.reply_pics[0]&&this.reply.reply_info.reply_pics[0].pic_url},limitedContent:function(){return Object(T.a)(this.reply.reply_info.reply_content,{maxLineCount:this.maxLineCount,perLineLength:this.perLineLength})},collapsed:function(){return this.limitedContent.length<this.reply.reply_info.reply_content.length&&!this.isShowAll&&this.reply.reply_info.reply_content.length-this.limitedContent.length>this.perLineLength},replyPlaceholder:function(){return"回复".concat(this.reply.user_info.user_name,"...")},perLineLength:function(){return this.$device.isMobile?30:40},maxLineCount:function(){return this.$device.isMobile?4:6},isAutoFocus:function(){return!this.user||this.user.isBindedPhone}},methods:{onSyncCommentNum:function(t){this.$emit("syncCommentNum",t)},isCurrentUsersReply:function(){return this.currentUser&&this.currentUser.user_id===this.reply.user_info.user_id},toggleLike:function(){var t=this;this.isLikeLoading||this.$ensureAuthorized("login").then((function(){t.isLikeLoading=!0,t.reply.user_interact.is_digg?Object(I.c)({itemId:t.reply.reply_info.reply_id,type:6}).then((function(e){t.isLikeLoading=!1,0!==e.err_no?t.$error(e.err_msg):(t.reply.reply_info.digg_count--,t.reply.user_interact.is_digg=!t.reply.user_interact.is_digg)})):Object(I.b)({itemId:t.reply.reply_info.reply_id,type:6}).then((function(e){t.isLikeLoading=!1,0!==e.err_no?t.$error(e.err_msg):(t.reply.reply_info.digg_count++,t.reply.user_interact.is_digg=!t.reply.user_interact.is_digg)}))}))},onReplyFormEmptyBlur:function(){var t=this;window.setTimeout((function(){t.isReplyFormVisible=!1}))},onSubmitted:function(){this.isReplyFormVisible=!1,this.$emit("submitted")},deleteComment:function(t){var e=this;this.$ensureAuthorized("login").then((function(){var o,n,r;window.confirm("确定删除这条评论吗？")&&(o={comment_id:t.reply_info.reply_comment_id,reply_id:t.reply_info.reply_id},n=o.comment_id,r=o.reply_id,Object(j.a)({url:"/interact_api/v1/reply/delete",method:"post",body:{comment_id:n,reply_id:r}}).then((function(t){return t.data}))).then((function(o){e.replyList.some((function(o,n){o.reply_info.reply_id===t.reply_info.reply_id&&e.replyList.splice(n,1)})),e.$alertMsg("删除成功"),e.$emit("syncCommentNum",{type:"sub"})})).catch((function(){e.$alertMsg("删除失败，刷新后重试")}))}))}}},V=(o(1363),{components:{SubComment:Object(S.a)(N,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"sub-comment"},[o("div",{staticClass:"sub-comment-content-row"},[o("div",{staticClass:"sub-comment-content-box"},[o("user-popover",{staticClass:"popover",attrs:{userId:t.reply.user_info.user_id}},[o("app-link",{staticClass:"username",attrs:{to:t.$userRoute(t.reply.user_info.user_id),blank:!0}},[o("avatar",{staticClass:"avatar",attrs:{user:t.reply.user_info,size:100}})],1)],1),o("div",{staticClass:"user-content-box"},[o("div",{staticClass:"profie"},[o("user-popover",{attrs:{userId:t.reply.user_info.user_id}},[o("username",{attrs:{user:t.reply.user_info}},[t.hasAuthorBadge?o("span",{staticClass:"author-badge-text"},[t._v("(作者)")]):t._e()])],1),o("div",{staticClass:"position"},[t._v(t._s(t.position))])],1),o("div",{staticClass:"content-box"},[t.reply.reply_user&&t.reply.reply_user.user_name?[o("span",[t._v(" 回复 ")]),o("user-popover",{attrs:{userId:t.reply.reply_user.user_id}},[o("app-link",{staticClass:"username be-replied",attrs:{to:t.$userRoute(t.reply.reply_user),blank:!0}},[t._v(t._s(t.reply.reply_user.user_name))])],1),o("span",[t._v(": ")])]:t._e(),t.collapsed?o("span",{directives:[{name:"parse-url-emoji",rawName:"v-parse-url-emoji",value:t.limitedContent,expression:"limitedContent"}],staticClass:"content"}):o("span",{directives:[{name:"parse-url-emoji",rawName:"v-parse-url-emoji",value:t.reply.reply_info.reply_content,expression:"reply.reply_info.reply_content"}],staticClass:"content"})],2),t.collapsed?o("span",{staticClass:"limit-btn",on:{click:function(e){t.isShowAll=!0}}},[t._v("展开")]):t._e(),t.imageUrl&&!t.collapsed?o("span",{staticClass:"image viewable",attrs:{"data-src":t.imageUrl}},[t._v("[图片]"),o("a",{staticClass:"image-preview"},[t.imageUrl&&!t.collapsed?o("thumb",{staticClass:"image viewable",attrs:{"data-src":t.imageUrl,url:t.imageUrl,width:400,height:340,format:"jpg"}}):t._e(),o("triangle",{staticClass:"triangle-top"})],1)]):t._e(),o("div",{staticClass:"limit-all-box"},[t.isShowAll?o("span",{staticClass:"limit-btn all",on:{click:function(e){t.isShowAll=!1}}},[t._v("收起")]):t._e()]),o("div",{staticClass:"sub-comment-stat-box"},[o("time",{staticClass:"time",attrs:{datetime:t._f("iso")(1e3*t.reply.reply_info.ctime),title:new Date(1e3*t.reply.reply_info.ctime)}},[t._v(t._s(t._f("relative")(1e3*t.reply.reply_info.ctime)))]),o("div",{staticClass:"delete",class:{removable:t.removableReply},on:{click:function(e){return t.deleteComment(t.reply)}}},[t._v("  · 删除")]),o("div",{staticClass:"sub-comment-action-box"},[o("div",{staticClass:"like-action action",class:{active:t.reply.user_interact.is_digg},on:{click:t.toggleLike}},[t.reply.user_interact.is_digg?[o("svg",{staticClass:"icon like-icon",attrs:{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 20 20"}},[o("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[o("path",{attrs:{d:"M0 0h20v20H0z"}}),t._v(" "),o("path",{attrs:{fill:"#37C700",stroke:"#37C700","stroke-linejoin":"round","stroke-width":".964",d:"M5.344 8.833V17H4.072C3.482 17 3 16.424 3 15.716V10.22c0-.739.502-1.387 1.072-1.387h1.272zM10.6 4.166c.106-.693.692-1.179 1.335-1.166.918.018 1.465.777 1.655 1.153.346.686.356 1.816.118 2.542-.215.657-.713 1.52-.713 1.52h3.732c.395 0 .762.193 1.006.526.248.341.33.784.218 1.187l-1.69 6.08c-.153.584-.662.992-1.236.992H7.219V8.504c1.686-.361 3.191-3.086 3.381-4.338z"}})])])]:[o("svg",{staticClass:"icon like-icon",attrs:{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 20 20"}},[o("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[o("path",{attrs:{d:"M0 0h20v20H0z"}}),t._v(" "),o("path",{attrs:{stroke:"#8A93A0","stroke-linejoin":"round",d:"M4.58 8.25V17h-1.4C2.53 17 2 16.382 2 15.624V9.735c0-.79.552-1.485 1.18-1.485h1.4zM11.322 2c1.011.019 1.614.833 1.823 1.235.382.735.392 1.946.13 2.724-.236.704-.785 1.629-.785 1.629h4.11c.434 0 .838.206 1.107.563.273.365.363.84.24 1.272l-1.86 6.513A1.425 1.425 0 0 1 14.724 17H6.645V7.898C8.502 7.51 9.643 4.59 9.852 3.249A1.47 1.47 0 0 1 11.322 2z"}})])])],t.reply.reply_info.digg_count?o("span",{staticClass:"action-title"},[t._v(t._s(t.reply.reply_info.digg_count))]):t._e()],2),o("div",{staticClass:"comment-action action",on:{click:function(e){t.isReplyFormVisible=!t.isReplyFormVisible}}},[o("svg",{staticClass:"icon comment-icon",attrs:{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 20 20"}},[o("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[o("path",{attrs:{d:"M0 0h20v20H0z"}}),t._v(" "),o("path",{attrs:{stroke:"#8A93A0","stroke-linejoin":"round",d:"M10 17c-4.142 0-7.5-2.91-7.5-6.5S5.858 4 10 4c4.142 0 7.5 2.91 7.5 6.5 0 1.416-.522 2.726-1.41 3.794-.129.156.41 3.206.41 3.206l-3.265-1.134c-.998.369-2.077.634-3.235.634z"}})])]),t._v(" "),o("span",[t._v("回复")])])])]),t.isReplyFormVisible?o("comment-form",{staticClass:"reply-form",attrs:{subject:t.subject,parent:t.parent,comment:t.reply,replyList:t.replyList,autoFocus:t.isAutoFocus,placeholder:t.replyPlaceholder},on:{emptyBlur:t.onReplyFormEmptyBlur,submitted:t.onSubmitted,syncCommentNum:t.onSyncCommentNum}}):t._e()],1)],1)])])}),[],!1,null,"35801ab3",null).exports},props:["subject","parent","expanded","removable","user"],data:function(){return{list:[],cursor:"0",limit:20,count:0,has_more:!0,loading:!1,showAll:!1}},computed:{fetchMoreTitle:function(){return this.loading?"加载中...":"加载更多"},canFetchMore:function(){var t=this.parent.comment_info.reply_count;return!!this.list.length&&(t>2&&t<=10&&(this.showAll=!0),this.expanded?"0"===this.cursor?this.parent.comment_info.reply_count>this.list.length:this.has_more:this.list.length&&this.parent.comment_info.reply_count>this.list.length)}},watch:{parent:function(t){this.list=t.reply_infos}},methods:{getRouterParams:function(){return{name:{2:"column",4:"pin",12:"book"}[this.subject.item_type],params:{id:this.subject.item_id}}},onSubmitted:function(){},refetch:function(){this.$emit("refetch")},fetchMore:function(){var t,e,o,n,cursor,r,c=this;!this.loading&&this.has_more&&(this.loading=!0,(t={comment_id:this.parent.comment_info.comment_id,item_id:this.subject.item_id,item_type:this.subject.item_type,cursor:this.cursor,limit:this.limit},e=t.comment_id,o=t.item_id,n=t.item_type,cursor=t.cursor,r=t.limit,Object(j.a)({url:"/interact_api/v1/reply/list",method:"post",body:{comment_id:e,item_id:o,item_type:n,cursor:cursor,limit:r,client_type:2608}})).then((function(t){var data=t.data,e=t.count,o=t.has_more,cursor=t.cursor;c.loading=!1,c.mergeList(data),c.count=e,c.has_more=o,c.cursor=cursor})).catch((function(t){c.loading=!1,console.error(t)})))},mergeList:function(t){var e,o=this.list.reduce((function(t,e){return t[e.reply_info.reply_id]=!0,t}),{}),r=t.filter((function(t){return!o[t.reply_info.reply_id]}));(e=this.list).push.apply(e,Object(n.a)(r))},onSyncCommentNum:function(t){this.$emit("syncCommentNum",t)}},mounted:function(){var t=this.parent.comment_info.reply_count;this.expanded&&t<=10&&t>2&&this.fetchMore(),this.list=this.parent.reply_infos}}),E=(o(1365),Object(S.a)(V,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"sub-comment-list"},[t._l(t.list,(function(e){return o("div",{key:e.reply_info.reply_id,staticClass:"item"},[o("sub-comment",{staticClass:"sub-comment",attrs:{"data-comment-id":e.reply_info&&e.reply_info.reply_id,subject:t.subject,parent:t.parent,reply:e,replyList:t.list,removable:t.removable,user:t.user},on:{submitted:t.onSubmitted,refetch:t.refetch,syncCommentNum:t.onSyncCommentNum}})],1)})),t._v(" "),t.canFetchMore?o("div",{staticClass:"item fetch-more"},[t.expanded||t.showAll?o("div",{staticClass:"fetch-more-comment",on:{click:t.fetchMore}},[t._v("\n      "+t._s(t.fetchMoreTitle)+"\n    ")]):o("app-link",{staticClass:"fetch-more-comment",attrs:{to:t.getRouterParams(),blank:!0}},[t._v("\n      查看更多 >\n    ")])],1):t._e()],2)}),[],!1,null,"21b4b888",null).exports),B={components:{Avatar:h.a,Thumb:R.a,CommentForm:U,SubCommentList:E,UserPopover:P.default},props:["list","subject","comment","expanded"],data:function(){return{likeLock:Object(A.a)(),isReplyFormVisible:!1,isShowAll:!1,isLikeLoading:!1}},computed:{currentUser:function(){var t=this.$store.getters;return"USER"in t?t.USER:null},isCurrentUsersSubject:function(){return this.currentUser&&this.currentUser.user_id===this.subject.user_id},isCurrentUsersComment:function(){return this.currentUser&&this.currentUser.user_id===this.comment.user_info.user_id},isAdmin:function(){return this.currentUser&&"admin"===this.currentUser.role},hasAuthorBadge:function(){return this.subject.user_id===this.comment.user_info.user_id},removable:function(){return this.isAdmin||this.isCurrentUsersSubject||this.isCurrentUsersComment},mobile:function(){return this.$device.isMobile},position:function(){return this.$userPosition(this.comment.user_info)},imageUrl:function(){return this.comment.comment_info.comment_pics[0]&&this.comment.comment_info.comment_pics[0].pic_url},limitedContent:function(){return Object(T.a)(this.comment.comment_info.comment_content,{maxLineCount:this.maxLineCount,perLineLength:this.perLineLength})},collapsed:function(){return this.limitedContent.length<this.comment.comment_info.comment_content.length&&!this.isShowAll&&this.comment.comment_info.comment_content.length-this.limitedContent.length>this.perLineLength},perLineLength:function(){return this.$device.isMobile?30:40},maxLineCount:function(){return this.$device.isMobile?4:6},replyPlaceholder:function(){return"回复".concat(this.comment.user_info.user_name,"...")},isAutoFocus:function(){return!this.currentUser||this.currentUser.isBindedPhone}},methods:{toggleLike:function(){var t=this;this.isLikeLoading||this.$ensureAuthorized("login").then((function(){t.isLikeLoading=!0,t.comment.user_interact.is_digg?Object(I.c)({itemId:t.comment.comment_info.comment_id,type:5}).then((function(e){t.isLikeLoading=!1,0!==e.err_no?t.$error(e.err_msg):(t.comment.comment_info.digg_count--,t.comment.user_interact.is_digg=!t.comment.user_interact.is_digg)})):Object(I.b)({itemId:t.comment.comment_info.comment_id,type:5}).then((function(e){t.isLikeLoading=!1,0!==e.err_no?t.$error(e.err_msg):(t.comment.comment_info.digg_count++,t.comment.user_interact.is_digg=!t.comment.user_interact.is_digg)}))}))},onReplyFormEmptyBlur:function(){var t=this;window.setTimeout((function(){t.isReplyFormVisible=!1}))},onSubmitted:function(){this.isReplyFormVisible=!1,this.$refs.subCommentList.onSubmitted()},refetch:function(){this.$emit("refetch")},deleteComment:function(t){var e=this;this.$ensureAuthorized("login").then((function(){var o,n;window.confirm("确定删除这条评论吗？")&&(o={comment_id:t.comment_info.comment_id},n=o.comment_id,Object(j.a)({url:"/interact_api/v1/comment/delete",method:"post",body:{comment_id:String(n)}}).then((function(t){return t.data}))).then((function(o){e.list.some((function(o,n){o.comment_info.comment_id===t.comment_info.comment_id&&e.list.splice(n,1)})),e.$alertMsg("删除成功"),e.$emit("syncCommentNum",{type:"sub",count:t.reply_infos.length})})).catch((function(){e.$alertMsg("删除失败，刷新后重试")}))}))},onSyncCommentNum:function(t){this.$emit("syncCommentNum",t)}}},H=(o(1367),Object(S.a)(B,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"comment"},[o("user-popover",{staticClass:"popover",attrs:{userId:t.comment.user_info.user_id}},[o("app-link",{staticClass:"user-link",attrs:{to:t.$userRoute(t.comment.user_info.user_id),blank:!0}},[o("avatar",{staticClass:"avatar",attrs:{user:t.comment.user_info,size:100,alt:t.comment.user_info.user_name+"的头像"}})],1)],1),o("div",{staticClass:"content-box comment-divider-line"},[o("div",{staticClass:"meta-box"},[o("user-popover",{attrs:{userId:t.comment.user_info.user_id}},[o("username",{staticClass:"ellipsis",attrs:{user:t.comment.user_info}},[t.hasAuthorBadge?o("span",{staticClass:"author-badge-text"},[t._v("(作者)")]):t._e()])],1),o("div",{staticClass:"position"},[t._v(t._s(t.position))])],1),t.collapsed?o("div",{directives:[{name:"parse-url-emoji",rawName:"v-parse-url-emoji",value:t.limitedContent,expression:"limitedContent"}],staticClass:"content"}):o("div",{directives:[{name:"parse-url-emoji",rawName:"v-parse-url-emoji",value:t.comment.comment_info.comment_content,expression:"comment.comment_info.comment_content"}],staticClass:"content"}),o("div",{staticClass:"limit-ctl-box"},[t.collapsed?o("div",{staticClass:"limit-btn",on:{click:function(e){t.isShowAll=!0}}},[t._v("展开")]):t._e(),t.isShowAll?o("div",{staticClass:"limit-btn",on:{click:function(e){t.isShowAll=!1}}},[t._v("收起")]):t._e()]),t.imageUrl&&!t.collapsed?o("thumb",{staticClass:"image viewable",attrs:{"data-src":t.imageUrl,url:t.imageUrl,width:160,height:160,format:"jpg"}}):t._e(),o("div",{staticClass:"reply-stat"},[o("time",{staticClass:"time",attrs:{datetime:t._f("iso")(1e3*t.comment.comment_info.ctime),title:new Date(1e3*t.comment.comment_info.ctime)}},[t._v(t._s(t._f("relative")(1e3*t.comment.comment_info.ctime)))]),o("div",{staticClass:"delete",class:{removable:t.removable},on:{click:function(e){return t.deleteComment(t.comment)}}},[t._v("  · 删除")]),o("div",{staticClass:"action-box"},[o("div",{staticClass:"like-action action",class:{active:t.comment.user_interact.is_digg},on:{click:t.toggleLike}},[t.comment.user_interact.is_digg?[o("svg",{staticClass:"icon like-icon",attrs:{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 20 20"}},[o("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[o("path",{attrs:{d:"M0 0h20v20H0z"}}),t._v(" "),o("path",{attrs:{fill:"#37C700",stroke:"#37C700","stroke-linejoin":"round","stroke-width":".964",d:"M5.344 8.833V17H4.072C3.482 17 3 16.424 3 15.716V10.22c0-.739.502-1.387 1.072-1.387h1.272zM10.6 4.166c.106-.693.692-1.179 1.335-1.166.918.018 1.465.777 1.655 1.153.346.686.356 1.816.118 2.542-.215.657-.713 1.52-.713 1.52h3.732c.395 0 .762.193 1.006.526.248.341.33.784.218 1.187l-1.69 6.08c-.153.584-.662.992-1.236.992H7.219V8.504c1.686-.361 3.191-3.086 3.381-4.338z"}})])])]:[o("svg",{staticClass:"icon like-icon",attrs:{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 20 20"}},[o("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[o("path",{attrs:{d:"M0 0h20v20H0z"}}),t._v(" "),o("path",{attrs:{stroke:"#8A93A0","stroke-linejoin":"round",d:"M4.58 8.25V17h-1.4C2.53 17 2 16.382 2 15.624V9.735c0-.79.552-1.485 1.18-1.485h1.4zM11.322 2c1.011.019 1.614.833 1.823 1.235.382.735.392 1.946.13 2.724-.236.704-.785 1.629-.785 1.629h4.11c.434 0 .838.206 1.107.563.273.365.363.84.24 1.272l-1.86 6.513A1.425 1.425 0 0 1 14.724 17H6.645V7.898C8.502 7.51 9.643 4.59 9.852 3.249A1.47 1.47 0 0 1 11.322 2z"}})])])],t.comment.comment_info.digg_count?o("span",{staticClass:"action-title"},[t._v(t._s(t.comment.comment_info.digg_count))]):t._e()],2),t.currentUser?o("div",{staticClass:"comment-action action",on:{click:function(e){t.isReplyFormVisible=!t.isReplyFormVisible}}},[o("svg",{staticClass:"icon comment-icon",attrs:{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 20 20"}},[o("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[o("path",{attrs:{d:"M0 0h20v20H0z"}}),t._v(" "),o("path",{attrs:{stroke:"#8A93A0","stroke-linejoin":"round",d:"M10 17c-4.142 0-7.5-2.91-7.5-6.5S5.858 4 10 4c4.142 0 7.5 2.91 7.5 6.5 0 1.416-.522 2.726-1.41 3.794-.129.156.41 3.206.41 3.206l-3.265-1.134c-.998.369-2.077.634-3.235.634z"}})])]),t._v(" "),o("span",{staticClass:"action-title"},[t._v("回复")])]):o("div",{staticClass:"comment-action action",on:{click:function(e){return t.$requestLogin()}}},[o("svg",{staticClass:"icon comment-icon",attrs:{"aria-hidden":"true",width:"16",height:"16",viewBox:"0 0 20 20"}},[o("g",{attrs:{fill:"none","fill-rule":"evenodd"}},[o("path",{attrs:{d:"M0 0h20v20H0z"}}),t._v(" "),o("path",{attrs:{stroke:"#8A93A0","stroke-linejoin":"round",d:"M10 17c-4.142 0-7.5-2.91-7.5-6.5S5.858 4 10 4c4.142 0 7.5 2.91 7.5 6.5 0 1.416-.522 2.726-1.41 3.794-.129.156.41 3.206.41 3.206l-3.265-1.134c-.998.369-2.077.634-3.235.634z"}})])]),t._v(" "),o("span",{staticClass:"action-title"},[t._v("回复")])])])]),t.isReplyFormVisible?o("comment-form",{staticClass:"reply-form",attrs:{subject:t.subject,comment:t.comment,replyList:t.comment.reply_infos,autoFocus:t.isAutoFocus,placeholder:t.replyPlaceholder},on:{emptyBlur:t.onReplyFormEmptyBlur,submitted:t.onSubmitted,syncCommentNum:t.onSyncCommentNum}}):t._e(),o("sub-comment-list",{ref:"subCommentList",staticClass:"sub-comment-list",attrs:{subject:t.subject,parent:t.comment,expanded:t.expanded,removable:t.isAdmin||t.isCurrentUsersSubject,user:t.currentUser},on:{refetch:t.refetch,syncCommentNum:t.onSyncCommentNum}})],1)],1)}),[],!1,null,"712cf1e5",null).exports),D={components:{ImageViewer:M.a,Comment:H},props:["subject","list","expanded"],methods:{initImageViewer:function(){this.$refs.imageViewer.attachContainer(this.$el)},refetch:function(){this.$emit("refetch")},onSyncCommentNum:function(t){this.$emit("syncCommentNum",t)}},mounted:function(){this.initImageViewer()}},W=(o(1369),{components:{CommentForm:U,CommentList:Object(S.a)(D,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"comment-list"},[o("image-viewer",{ref:"imageViewer",attrs:{selector:".viewable"}}),t._v(" "),t._l(t.list,(function(e){return o("div",{key:e.comment_id,staticClass:"item"},[o("comment",{staticClass:"comment",attrs:{"data-comment-id":e.comment_id,list:t.list,comment:e,subject:t.subject,expanded:t.expanded},on:{refetch:t.refetch,syncCommentNum:t.onSyncCommentNum}})],1)}))],2)}),[],!1,null,"7d46cf26",null).exports,Triangle:c.a},props:["subject","expanded","sticky","forbidInput"],data:function(){return{list:[],cursor:"0",limit:20,count:0,has_more:!0,loading:!1,listSize:0}},computed:{hidden:function(){return!!this.$isServer||document.body.clientWidth<960&&this.sticky}},watch:{"subject.item_id":{handler:function(t){t&&this.fetch()},immediate:!0}},methods:{getRouterParams:function(){return{name:{2:"column",4:"pin",12:"book"}[this.subject.item_type],params:{id:this.subject.item_id}}},fetch:function(){var t=this,e=this.subject,o=e.item_id,n=e.item_type;!this.loading&&o&&(this.loading=!0,this.limit=this.expanded?20:7,this.cursor="0",this.count=0,this.has_more=!0,$({item_id:o,item_type:n,cursor:this.cursor,limit:this.limit}).then((function(e){var data=e.data,cursor=e.cursor,o=e.count,n=e.has_more;t.listSize=data.length,t.loading=!1,t.list=t.expanded?data:data.slice(0,6),t.count=o,t.cursor=cursor,t.has_more=n})).catch((function(e){t.loading=!1,console.error(e)})))},fetchMore:function(){var t=this;if(!this.loading&&this.has_more){this.loading=!0;var e=this.subject;$({item_id:e.item_id,item_type:e.item_type,cursor:this.cursor,limit:this.limit}).then((function(e){var data=e.data,cursor=e.cursor,o=e.count,n=e.has_more;t.listSize=data.length,t.loading=!1,t.mergeList(data),t.count=o,t.cursor=cursor,t.has_more=n})).catch((function(e){t.loading=!1,console.error(e)}))}},mergeList:function(t){var e,o=this.list.reduce((function(t,e){return t[e.comment_id]=!0,t}),{}),r=t.filter((function(t){return!o[t.comment_id]}));(e=this.list).push.apply(e,Object(n.a)(r))},fetchMoreIfConditionIsSatisfied:function(){Object(r.b)(this.$el)>-200&&this.fetchMore()},onSubmitted:function(){},onRefetch:function(){this.fetch()},onSyncCommentNum:function(t){this.$emit("syncCommentNum",t)}},mounted:function(){var t=this;if(this.expanded){var e=this.$getBean("eventBus");e.onVmLife(this,e.eventType.ROOT_CONTAINER_SCROLL,(function(){t.fetchMoreIfConditionIsSatisfied()})),Object(r.h)(this.$el,(function(){t.fetchMoreIfConditionIsSatisfied()}))}this.fetch()}}),G=(o(1371),Object(S.a)(W,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{key:t.subject.item_id,staticClass:"comment-list-box",class:{sticky:t.sticky}},[t.hidden?o("div",{staticClass:"title"},[t._v("评论")]):t._e(),t._v(" "),t.forbidInput?t._e():o("comment-form",{staticClass:"comment-form",attrs:{commentList:t.list,subject:t.subject},on:{submitted:t.onSubmitted,syncCommentNum:t.onSyncCommentNum}}),t._v(" "),t.list.length?o("comment-list",{staticClass:"comment-list",attrs:{list:t.list,subject:t.subject,expanded:t.expanded},on:{refetch:t.onRefetch,syncCommentNum:t.onSyncCommentNum}}):t._e(),t._v(" "),!t.expanded&&t.list.length<t.subject.comment_count&&t.subject.comment_count>6&&t.listSize>6?o("app-link",{staticClass:"fetch-more-comment",attrs:{to:t.getRouterParams(),blank:!0}},[t._v("\n    查看更多 >\n  ")]):t._e(),t._v(" "),o("triangle",{staticClass:"triangle-top",style:{display:t.hidden?"none":"block"}})],1)}),[],!1,null,"dace33a0",null));e.a=G.exports},972:function(t,e,o){var content=o(1362);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(80).default)("594d2439",content,!0,{sourceMap:!1})},973:function(t,e,o){var content=o(1364);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(80).default)("5d01106f",content,!0,{sourceMap:!1})},974:function(t,e,o){var content=o(1366);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(80).default)("3357429b",content,!0,{sourceMap:!1})},975:function(t,e,o){var content=o(1368);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(80).default)("7ab9da61",content,!0,{sourceMap:!1})},976:function(t,e,o){var content=o(1370);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(80).default)("60c57a14",content,!0,{sourceMap:!1})},977:function(t,e,o){var content=o(1372);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,o(80).default)("c34d32ca",content,!0,{sourceMap:!1})}}]);